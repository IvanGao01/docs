---
title: 函数
order: 9
---

## **数学函数**
### **abs(x)**
**功能**：   返回x的绝对值。

**参数类型**：数值类型

**返回类型**：与函数参数类型一致

**示例**：

```sql
SELECT abs(-1);
```

    +----------------+
    | abs(Int64(-1)) |
    +----------------+
    | 1              |
    +----------------+

----------------

### **acos(x)**
**功能**：   返回x的反余弦值。

**参数类型**：数值类型

**返回类型**：DOUBLE

**示例**：

```sql
SELECT acos(3);
```

    +----------------+
    | acos(Int64(3)) |
    +----------------+
    | NaN            |
    +----------------+

```sql
SELECT acos(0.5);
```

    +--------------------+
    | acos(Float64(0.5)) |
    +--------------------+
    | 1.0471975511965976 |
    +--------------------+

----------------

### **asin(x)**
**功能**：   返回x的反正弦值。

**参数类型**：数值类型

**返回类型**：DOUBLE

**示例**：
```sql
SELECT asin(0.5);
```
    +--------------------+
    | asin(Float64(0.5)) |
    +--------------------+
    | 0.5235987755982988 |
    +--------------------+

```sql
SELECT asin(5);
```
    +----------------+
    | asin(Int64(5)) |
    +----------------+
    | NaN            |
    +----------------+

----------------

### **atan(x)**
**功能**：   返回x的反正切值。

**参数类型**：数值类型

**返回类型**：DOUBLE

**示例**：
```sql
SELECT atan(5);
```

    +-------------------+
    | atan(Int64(5))    |
    +-------------------+
    | 1.373400766945016 |
    +-------------------+

----------------

### **atan2(y,x)**
**功能**：   返回y/x的反正切值。

**参数类型**：数值类型

**返回类型**：DOUBLE

```sql
SELECT atan2(10, 2);
```

    +---------------------------+
    | atan2(Int64(10),Int64(2)) |
    +---------------------------+
    | 1.3734008                 |
    +---------------------------+

----------------

### **ceil(x)**
**功能**：   向上取整。

**参数类型**：数值类型

**返回类型**：BIGINT

```sql
SELECT ceil(1.6);
```
    +--------------------+
    | ceil(Float64(1.6)) |
    +--------------------+
    | 2                  |
    +--------------------+

----------------


### **floor(x)**
**功能**：   向下取整

**参数类型**：数值类型

**返回类型**：BIGINT

```sql
SELECT floor(-3.1);
```
    +----------------------+
    | floor(Float64(-3.1)) |
    +----------------------+
    | -4                   |
    +----------------------+

----------------

### **cos(x)**
**功能**：   返回x的余弦值。

**参数类型**：数值类型

**返回类型**：DOUBLE

**示例**：
```sql
SELECT cos(1);
```
    +--------------------+
    | cos(Int64(1))      |
    +--------------------+
    | 0.5403023058681398 |
    +--------------------+

--------------------
### **sin(x)**
**功能**：   x的正弦值

**参数类型**：数值类型

**返回类型**：DOUBLE

```sql
SELECT sin(5);
```
    +---------------------+
    | sin(Int64(5))       |
    +---------------------+
    | -0.9589242746631385 |
    +---------------------+
----------------

### **exp(x)**
**功能**：   返回e的x次方。

**参数类型**：数值类型

**返回类型**：DOUBLE

```sql
SELECT exp(1);
```
    +-------------------+
    | exp(Int64(1))     |
    +-------------------+
    | 2.718281828459045 |
    +-------------------+

----------------

### **ln(x)**
**功能**：   自然对数

**参数类型**：数值类型

**返回类型**：DOUBLE
```sql
SELECT ln(2.718281828459045);
```
    +--------------------------------+
    | ln(Float64(2.718281828459045)) |
    +--------------------------------+
    | 1                              |
    +--------------------------------+

----------------



### **log(x) | log10(x)**
**功能**：   以10为底的对数

**参数类型**：数值类型

**返回类型**：DOUBLE

```sql
SELECT log(10);
```
    +----------------+
    | log(Int64(10)) |
    +----------------+
    | 1              |
    +----------------+

```sql
SELECT log10(10);
```

    +----------------+
    | log(Int64(10)) |
    +----------------+
    | 1              |
    +----------------+

----------------

### **log2(x)**
**功能**：   以 2 为底的对数

**参数类型**：数值类型

**返回类型**：DOUBLE


```sql
SELECT log2(4);
```

    +----------------+
    | log2(Int64(4)) |
    +----------------+
    | 2              |
    +----------------+
----------------

### **power(x,y) | pow(x,y)**
**功能**：   x的y次方

**参数类型**：数值类型

**返回类型**：DOUBLE

```sql
SELECT power(2, 3);
```
    +--------------------------+
    | power(Int64(2),Int64(3)) |
    +--------------------------+
    | 8                        |
    +--------------------------+
----------------

### **round(x)**
**功能**：   四舍五入到最接近的整数

**参数类型**：数值类型

**返回类型**：BIGINT

```sql
SELECT round(3.5);
```
    +---------------------+
    | round(Float64(3.5)) |
    +---------------------+
    | 4                   |
    +---------------------+

----------------

### **signum(x)**
**功能**：   参数的符号 (-1, 0, +1)

**参数类型**：数值类型

**返回类型**：BIGINT

```sql
SELECT signum(-3);
```

    +-------------------+
    | signum(Int64(-3)) |
    +-------------------+
    | -1                |
    +-------------------+

----------------

### **sqrt(x)**
**功能**：   x的平方根

**参数类型**：数值类型

**返回类型**：与函数参数类型一致

```sql
SELECT sqrt(4);
```
    +----------------+
    | sqrt(Int64(4)) |
    +----------------+
    | 2              |
    +----------------+

----------------

### **tan(x)**
**功能**：    x的正切值

**参数类型**：数值类型

**返回类型**： DOUBLE

```sql
SELECT tan(1);
```
    +-------------------+
    | tan(Int64(1))     |
    +-------------------+
    | 1.557407724654902 |
    +-------------------+

----------------

### **trunc(x)**
**功能**：向零取整

**参数类型**：数值类型

**返回类型**：BIGINT
```sql
SELECT trunc(-3.9);
```
    +----------------------+
    | trunc(Float64(-3.9)) |
    +----------------------+
    | -3                   |
    +----------------------+

----------------

### **struct**

    struct(expr1 [, ...] ) 

**功能**：创建一个具有指定字段值的 STRUCT。

**参数类型**：数值类型

**注意**：struct函数目前功能并不完善

--------------------------

## **条件函数**

### **coalesce**
    coalesce(expr[,...exp])
**功能**：返回其第一个不为空的参数。只有当所有参数都为 null 时才返回 Null。当检索数据以进行显示时，它通常用于将默认值替换为空值。

**参数类型**：任意

**返回类型**：第一个不为null的参数类型
```sql
SELECT coalesce(temperature, null, station) FROM air;
```
    +--------------------------------------------+
    | coalesce(air.temperature,NULL,air.station) |
    +--------------------------------------------+
    | 69.0                                       |
    | 78.0                                       |
    | 62.0                                       |
    | 79.0                                       |
    | 53.0                                       |
    | 72.0                                       |
    | 71.0                                       |
    | 69.0                                       |
    | 80.0                                       |
    | 74.0                                       |
    | 70.0                                       |
    | 70.0                                       |
    | 70.0                                       |
    +--------------------------------------------+
----------------

### **nullif**
    nullif(expr1, expr2) 

**功能**：如果 expr1 等于 expr2，则返回 NULL；否则返回 expr1。

**参数类型**：expr1,expr2为数值类型，且为带列值的表达式

**返回类型**：expr1的类型或NULL

```sql
SELECT nullif(temperature, 70) FROM air;
```
    +-----------------------------------+
    | nullif(air.temperature,Int64(70)) |
    +-----------------------------------+
    | 69                                |
    | 78                                |
    | 62                                |
    | 79                                |
    | 53                                |
    | 72                                |
    | 71                                |
    | 69                                |
    | 80                                |
    | 74                                |
    |                                   |
    |                                   |
    |                                   |
    +-----------------------------------+

----------------

## **字符串函数**

[//]: # (### **Array**)
[//]: # (    创建数组)

### **ascii**

    ascii(str) 

**功能**: 将 str 中的第一个字符转换成其ASCII 码后返回。

**参数类型**：STRING

**返回类型**：BIGINT

```sql
SELECT ascii('abc');
```
    +------------------+
    | ascii(Utf8("a")) |
    +------------------+
    | 97               |
    +------------------+

```sql
SELECT ascii('a');
```

    +------------------+
    | ascii(Utf8("a")) |
    +------------------+
    | 97               |
    +------------------+

----------------

### **bit_length**

    bit_length(str) 

**功能**：返回字符串数据的位长度或二进制数据的位数。

**参数类型**：STRING

**返回类型**：BIGINT

```sql
SELECT bit_length('abc');
```
    +------------------------+
    | bitlength(Utf8("abc")) |
    +------------------------+
    | 24                     |
    +------------------------+
----------------

### **btrim**

    btrim(string [, matching_string ] ) 

**功能**：函数通过删除前导空格和尾随空格或删除与可选的指定字符串匹配的字符来剪裁字符串。

**参数类型**：STRING

**返回类型**: STRING

```sql
SELECT btrim('     abc                  ');
```
    +-------------------------------------------+
    | btrim(Utf8("     abc                  ")) |
    +-------------------------------------------+
    | abc                                       |
    +-------------------------------------------+

```sql
SELECT btrim('111abc111','1');
```
    +------------------------------------+
    | btrim(Utf8("111abc111"),Utf8("1")) |
    +------------------------------------+
    | abc                                |
    +------------------------------------+

----------------

### **char_length | character_length**

    char_length(expr) 

**功能**：以字符数形式返回指定字符串的长度。

**参数类型**：STRING

**返回类型**：BIGINT

```sql
SELECT char_length('你好');
```
    +-------------------------------+
    | characterlength(Utf8("你好"))  |
    +-------------------------------+
    | 2                             |
    +-------------------------------+

----------------

### **chr**

    chr(expr) 

**功能**：返回位于提供的 UTF-16 码位的字符。

**参数类型**: BIGINT

**返回类型**: STRING
```sql
SELECT chr(20005);
```
    +-------------------+
    | chr(Int64(20005)) |
    +-------------------+
    | 严                |
    +-------------------+

----------------

### **concat**

    concat(expr1, expr2 [, ...exp] ) 

**功能**：联接两个或两个以上表达式并返回生成的表达式。

**参数类型**：STRING

**返回类型**: STRING
```sql
SELECT concat('a', 'b', 'c');
```

    +---------------------------------------+
    | concat(Utf8("a"),Utf8("b"),Utf8("c")) |
    +---------------------------------------+
    | abc                                   |
    +---------------------------------------+

----------------

### **concat_ws**

    concat_ws(sep , expr1 [, ...] ) 

**功能**：返回由 sep 分隔的串联字符串。

**参数类型**：STRING

**返回类型**：STRING

```sql
SELECT concat_ws(' ', 'a', 'b', 'c');
```
    +--------------------------------------------------------------+
    | concatwithseparator(Utf8(" "),Utf8("a"),Utf8("b"),Utf8("c")) |
    +--------------------------------------------------------------+
    | a b c                                                        |
    +--------------------------------------------------------------+

----------------

### **initcap**

    initcap(expr) 

**功能**：将参数中每个单词的首字母大写。

**参数类型**：STRING

**返回类型**：BIGINT

```sql
SELECT initcap('hello world');
```
    +------------------------------+
    | initcap(Utf8("hello world")) |
    +------------------------------+
    | Hello World                  |
    +------------------------------+

----------------

### **left**

    left(str, len) 

**功能**：返回 str 中最左边的 len 个字符。

**参数类型**：str为STRING类型，len为BIGINT类型

**返回类型**：STRING

```sql
SELECT left('abcde', 3);
```
    +------------------------------+
    | left(Utf8("abcde"),Int64(3)) |
    +------------------------------+
    | abc                          |
    +------------------------------+

----------------

### **lpad**

    lpad(expr, len [, pad] ) 

**功能**：返回 expr左侧填充了 pad，填充后长度为 len。

**参数类型**：expr, pad 类型为 STRING， len类型为BIGINT

**返回类型**：BIGINT

当len为负数时，len表现为0，当len过大，函数执行失败

```sql
SELECT lpad('abc', 10, '1');
```
    +---------------------------------------+
    | lpad(Utf8("abc"),Int64(10),Utf8("1")) |
    +---------------------------------------+
    | 1111111abc                            |
    +---------------------------------------+

----------------

### **rpad**

    rpad(expr, len [, pad] ) 

**功能**：返回右侧填充了 pad 的 expr，填充后整个字符的长度为 len。

**参数类型**：expr, pad 类型为 STRING， len类型为BIGINT

**返回类型**：STRING
```sql
SELECT rpad('aaa', 10, 'b');
```
    +---------------------------------------+
    | rpad(Utf8("aaa"),Int64(10),Utf8("b")) |
    +---------------------------------------+
    | aaabbbbbbb                            |
    +---------------------------------------+

----------------

### **lower**

    lower(expr) 

**功能**：返回字母小写。

**参数类型**：STRING

**返回类型**：STRING

```sql
SELECT lower('ABC');
```

    +--------------------+
    | lower(Utf8("ABC")) |
    +--------------------+
    | abc                |
    +--------------------+
----------------
### **ltrim**

    ltrim(str[, trimstr] ) 

**功能**：返回 str，其中删除了 trimStr 内的前导字符。默认trimestr为空白符

**参数类型**：STRING

**返回类型**：STRING
```sql
SELECT ltrim('   abc');
```
    +-----------------------+
    | ltrim(Utf8("   abc")) |
    +-----------------------+
    | abc                   |
    +-----------------------+


----------------

### **md5**

    md5(expr) 

**功能**：以十六进制字符串形式返回 expr 的 MD5 128 位校验和。

**参数类型**：STRING

**返回类型**：STRING
```sql
SELECT md5('abc');
```
    +----------------------------------+
    | md5(Utf8("abc"))                 |
    +----------------------------------+
    | 900150983cd24fb0d6963f7d28e17f72 |
    +----------------------------------+
----------------

### **octet_length**

    octet_length(expr) 

**功能**：返回字符串数据的字节长度。

**参数类型**：STRING

**返回类型**：BIGINT
```sql
SELECT octet_length('你好');
```
    +---------------------------+
    | octetlength(Utf8("你好")) |
    +---------------------------+
    | 6                         |
    +---------------------------+

----------------

### **random**

    random( [seed] ) 

**功能**：返回介于 0 和 1 之间的随机值。

**参数类型**：无

**返回类型**：DOUBLE

```sql
SELECT random();
```
    +---------------------+
    | random()            |
    +---------------------+
    | 0.37577771377596325 |
    +---------------------+

[//]: # (### **Regexp_Replace**)
[//]: # (    regexp_replace&#40;str, regexp, rep [, position] &#41; )
[//]: # (**功能**：将 str 中与 regexp 匹配的所有子字符串都替换为 rep。)
[//]: # (**参数类型**：STRING)
[//]: # (**返回类型**：BIGINT)

----------------

### **repeat**

    repeat(expr, n) 

**功能**：返回重复 expr, n 次的字符串。

**参数类型**：expr类型为STRING，n类型为BIGINT

**返回类型**：BIGINT
```sql
SELECT repeat('a', 5);
```
    +----------------------------+
    | repeat(Utf8("a"),Int64(5)) |
    +----------------------------+
    | aaaaa                      |
    +----------------------------+

----------------

### **replace**

    replace(str, search, replace ) 

**功能**：将所有 search 项都替换为 replace。

**参数类型**：STRING

**返回类型**：BIGINT
```sql
SELECT replace('aaa', 'a', 'b');
```
    +------------------------------------------+
    | replace(Utf8("aaa"),Utf8("a"),Utf8("b")) |
    +------------------------------------------+
    | bbb                                      |
    +------------------------------------------+

----------------

### **reverse**

    reverse(expr) 

**功能**：返回一个反向字符串或一个包含逆序的元素的数组。

**参数类型**：STRING

**返回类型**：BIGINT

```sql
SELECT reverse('你好');
```
    +-----------------------+
    | reverse(Utf8("你好")) |
    +-----------------------+
    | 好你                  |
    +-----------------------+
----------------

### **right**

    right(str, len) 

**功能**：返回字符串 str 中最右边的 len 个字符。

**参数类型**：STRING

**返回类型**：BIGINT
```sql
 SELECT right('aaabbb', 3);
```
    +--------------------------------+
    | right(Utf8("aaabbb"),Int64(3)) |
    +--------------------------------+
    | bbb                            |
    +--------------------------------+


----------------

### **digest**

    digest(expr, algorithm)

**功能**：把表达式用给定算法计算散列值

**参数类型**：expr, algorithm都为STRING类型

仅支持 md5, sha224, sha256, sha384, sha512, blake2s, blake2b, blake3算法

**返回类型**：BIGINT
```sql
SELECT digest('abc', 'md5');
```
    +----------------------------------+
    | digest(Utf8("abc"),Utf8("md5"))  |
    +----------------------------------+
    | 900150983cd24fb0d6963f7d28e17f72 |
    +----------------------------------+

----------------

### **rtrim**

    rtrim( str [, trimstr] ) 

**功能**：返回删除了尾随字符trimstr的str，trimstr默认是空白字符。

**参数类型**：STRING

**返回类型**：STRING
```sql
SELECT rtrim('aaabbb', 'b');
```
    +---------------------------------+
    | rtrim(Utf8("aaabbb"),Utf8("b")) |
    +---------------------------------+
    | aaa                             |
    +---------------------------------+

----------------

### **sha224**
    sha224(str)

**功能**：计算字符串的 sha224 散列值

**返回类型**：BINARY

**参数类型**：STRING

----------------

### **sha256**
    sha256(str)
**功能**：    计算字符串的 sha256 散列值

**返回类型**：BINARY

**参数类型**：STRING

----------------

### **sha384**
    sha256(str)
**功能**：   计算字符串的 sha384 散列值

**返回类型**：BINARY

**参数类型**：STRING

----------------

### **sha512**

    sha512(str)

**功能**： 计算字符串的 sha512 散列值

**返回类型**：BINARY

**参数类型**：STRING

----------------

### **split_part**

    split_part(str, delim, n) 

**功能**： 将 str 按照 delim 做拆分，返回第n部分。

**参数类型**：str，delim类型为STRING，partNum类型为BIGINT

**返回类型**：STRING

----------------

### **starts_with**

    starts_with(expr, startExpr) 

**功能**： 如果 expr 以 startExpr 开头，则返回 true。

**参数类型**：STRING

**返回类型**：BOOLEAN

----------------

### **strpos**

    strpos(str, substr ) 

**功能**：返回子字符串在指定字符串中的位置。

**参数类型**：STRING

**返回类型**：BIGINT

----------------

### **substr**

    substr(expr, pos [, len] ) 

**功能**： 返回 expr 的子字符串（从 pos 开始，长度为 len）。

**参数类型**：expr 类型为STRING，pos，len类型为BIGINT

**返回类型**：STRING

----------------

### **to_hex**

    to_hex(value)

**功能**： 将数字或二进制值转换为十六进制表示形式。

**参数类型**：BIGINT

**返回类型**：STRING

----------------

### **translate**

    translate(expr, from, to) 

**功能**： 返回一个 expr，其中 from 中的所有字符都替换为 to 中的字符。

**参数类型**：STRING

**返回类型**：STRING

----------------

### **trim**

    trim(str) 

**功能**：删除str首尾的空白字符

**参数类型**：STRING

**返回类型**：STRING

----------------

### **upper**

    upper(expr)

**功能**：返回将 expr 的所有字符均更改为大写后的结果。

**参数类型**：STRING

**返回类型**：STRING

## 时间函数

### **date_part**

    date_part(field, expr) 

**功能**：提取部分日期、时间戳或间隔。

**参数类型**：

field 类型为STRING，且只能是('year', 'quarter', 'month', 'week', 'day', 'doy', 'dow', 'hour', 'minute', '
second')中的一种

expr 类型为 TIMESTAMP

**返回类型**：BIGINT

----------------

### **date_trunc**

    date_trunc(field, expr) 

**功能**：返回已截断到 field 中指定的单位的值。

**参数类型**：field 类型为STRING，且只能是('year', 'quarter', 'month', 'week', 'day', 'doy', 'dow', 'hour', 'minute', '
second')中的一种

expr 类型为TIMESTAMP

----------------

### **date_bin**
    date_bin(interval, source, origin)
**功能**： 从origin开始，按interval切分bucket，返回source所在的bucket timestamp

**参数类型**：

interval 是 STRING 类型，会解析成时间间隔，

source, origin 是 TIMESTAMP 类型

**返回类型**：TIMESTAMP

----------------

### **to_timestamp**

    to_timestamp(expr [, fmt] ) 

**功能**：返回使用可选格式设置强制转换为某个时间戳的 expr。

**参数类型**：STRING类型

**返回类型**：TIMESTAMP类型

----------------

### **to_timestamp_millis**

    to_timestamp_millis(expr [, fmt] ) 

**功能**：返回使用可选格式设置强制转换为Timestamp(Millisseconds, None)格式。

----------------

### **to_timestamp_micros**

    to_timestamp_micros(expr [, fmt] ) 
**功能**：返回使用可选格式设置强制转换为Timestamp(Microseconds, None)格式。

---------

### **to_timestamp_seconds**
    to_timestamp_seconds(expr [, fmt] ) 
**功能**：返回使用可选格式设置强制转换为Timestamp(Seconds, None)格式。

----------------

### **from_unixtime**
    from_unixtime(unixTime [, fmt]) 

**功能**：返回 unixTime。

----------------

### **now**
    Timestamp(Nanoseconds, UTC) 


**功能**：返回当前时间戳

**返回类型**：TIMESTAMP



[//]: # (### **Regexp_Match**)
[//]: # (    返回与正则表达式匹配的项)
